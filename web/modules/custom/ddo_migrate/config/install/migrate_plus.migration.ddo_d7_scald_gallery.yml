langcode: fr
status: true
dependencies: {}
id: ddo_d7_scald_gallery
migration_tags:
  - "Drupal 7"
  - Content
migration_group: ddo_migrate
label: "Scald galleries"
source:
  plugin: migrate_source_scald_atom
  atom_type: gallery

process:
  name: title
  created: created
  changed: timestamp
  uid:
    plugin: migration_lookup
    migration: ddo_d7_user
    source: publisher
  status:
    plugin: default_value
    default_value: 1

  field_authors:
    plugin: migration_lookup
    migration: ddo_d7_taxonomy_term_scald_authors
    source: scald_authors

  field_tags:
    plugin: migration_lookup
    migration: ddo_d7_taxonomy_term_scald_tags
    source: scald_tags


    # field_media_slideshow/target_id:
    #   plugin: extract
    #   source: items
    #   index:
    #     - sid

    # field_media_slideshow:
    #   plugin: sub_process
    #   source: items
    #   process:
    #     target_id: sid

  field_media_slideshow:
    plugin: sub_process
    source: items
    process:
      target_id:
        plugin: migration_lookup
        migration: 
          - ddo_d7_scald_image
          - ddo_d7_scald_video
        source: sid

destination:
  plugin: "entity:media"
  default_bundle: gallery

migration_dependencies:
  required:
    #~ - ddo_d7_file
    - ddo_d7_user
    - ddo_d7_taxonomy_term_scald_authors
    - ddo_d7_taxonomy_term_scald_tags
  optional: {}
